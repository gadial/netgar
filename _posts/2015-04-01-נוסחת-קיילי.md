---
id: 2180
title: נוסחת קיילי
date: 2015-04-01T00:01:43+03:00
author:
  - "פרופ' דניאל קלייטמן, תרגם: אליהו לוי"
excerpt: '<p style="direction: rtl;"><img class="alignright size-full wp-image-2427" src="{{site.baseurl}}/assets/img/2015/02/photo-kleitman.jpg" alt="photo-kleitman" width="95" height="114" />יש כאלו שסופרים כבשים כדי להירדם, ויש כאלו שסופרים עצים. המתמטיקאי האנגלי ארתור קיילי (1821 - 1895) ספר עצים, והנוסחה שגילה היא אחת הנוסחאות היפות, ועם זאת המסתוריות, בקומבינטוריקה. יש לה הרבה הוכחות יפות, ואחת מהן, של דניאל קלייטמן, מתמטיקאי בן זמננו מ-MIT, תובא כאן.</p>'
layout: post
guid: http://net-gar.net/?p=2180
permalink: '/2015/04/01/cayley-formula/'
categories:
  - גליון 14 אפריל 2015
  - קומבינטוריקה
issue: 14
place: 4
---
<h4 dir="rtl" style="text-align: center;">
  פרופ' דניאל קלייטמן, Daniel J. Kleitman), MIT), ארה"ב<br /> הרצאה שניתנה במועדון המתמטי בטכניון בשנות ה-90 של המאה הקודמת
</h4>

<p style="direction: rtl;">
  <b>גרף</b> מורכב משתי קבוצות: ה<b>קודקודים</b>, ה<b>צלעות</b>. כל צלע היא זוג של קודקודים שונים. אנו נתבונן בגרפים סופיים, ויהי $latex {n}$ מספר אברי קבוצת הקודקודים. ל<b>גרף</b> <b>מכוון</b> יש צלעות מכוונות, זאת אומרת צלע היא <i>זוג מסודר של קודקודים</i>, אחד הוא ה<b>ראש</b> של הצלע והשני הוא ה<b>זנב</b> שלה.
</p>

<p style="direction: rtl;">
  <b>מסלול</b> בגרף מהקודקוד $latex {x}$ לקודקוד $latex {y}$ הוא <i>רשימה של צלעות</i> כך ש:
</p>

<p style="direction: rtl;">
  ה<i>צלע הראשונה מכילה את $latex {x}$</i> וה<i>צלע האחרונה מכילה את $latex {y}$;</i><br /> לכל צלע ברשימה יש קודקוד משותף עם הצלע העוקבת לה, וקודקוד אחר משותף עם הצלע הקודמת לה.
</p>

<p style="direction: rtl;">
  גרף נקרא <b>קשיר</b> אם יש <i>מסלול מכל קודקוד לכל קודקוד אחר בו</i>. <b>עץ</b> הוא <i>גרף קשיר שיחדל להיות קשיר אם יוציאו ממנו איזושהי צלע שלו.</i><br /> (לעץ יש $latex {n-1}$ צלעות: אם לגרף $latex {G}$ אין צלעות אזי כל קודקוד הוא מבודד והגרף מורכב מ $latex {n}$ בלוקים קשירים זרים שכל אחד מהם מורכב מקודקוד אחד. כל צלע שנוספת ל $latex {G}$ או מחברת שני בלוקים ובכך מקטינה את מספר הבלוקים באחד, או נמצאת בתוך בלוק קיים, ובמקרה זה אפשר להשמיטה מ $latex {G}$ בלי לקלקל את הקשירות. אם כך, אחרי הוספת $latex {n-1}$ צלעות הכרחיות-לקשירות לגרף ללא צלעות, הוא ייהפך לקשיר.)<br /> <b>מעגל</b> הוא <i>מסלול מקודקוד לעצמו שמכיל כל קודקוד אחר בשתים מהצלעות שבו לכל היותר.</i> <b>בעץ אין מעגלים:</b> ממעגל אפשר להשמיט צלע בלי להקטין את מידת הקשירות.
</p>

<p style="direction: rtl;" align="center">
  $latex {n=6}$
</p>

<p style="direction: rtl; text-align: center;">
  <img class="aligncenter size-full wp-image-2219" src="{{site.baseurl}}/assets/img/2015/02/kl-cy1_1.jpg" alt="kl-cy1_1" width="88" height="98" />
</p>

<p style="direction: rtl; text-align: center;">
  גרף
</p>

<p style="direction: rtl; text-align: center;">
  <img alt="" width="0.1\textwidth" /><img class="aligncenter size-full wp-image-2218" src="{{site.baseurl}}/assets/img/2015/02/kl-cy1_2.jpg" alt="kl-cy1_2" width="88" height="98" />
</p>

<p style="direction: rtl; text-align: center;">
  עץ
</p>

<p style="direction: rtl; text-align: center;">
  <img alt="" width="0.1\textwidth" /><img class="aligncenter size-full wp-image-2227" src="{{site.baseurl}}/assets/img/2015/02/kl-cy1_3.jpg" alt="kl-cy1_3" width="82" height="52" />
</p>

<p style="direction: rtl; text-align: center;">
  מעגל
</p>

<p style="direction: rtl;">
  במאה התשע-עשרה, קיילי $latex Cayley$ שאל וענה על השאלה הבאה: כמה עצים שונים יש עם קבוצה נתונה של $latex {n}$ קודקודים? מאז הופיעו הוכחות רבות של התוצאה שלו. אנו מציגים כאן הוכחה שהיא אולי חדשה.
</p>

<p style="direction: rtl;">
  נראה קודם אם נוכל לנחש את התשובה: כדי לעשות כך נבדוק את המקרים הקטנים: למרבה המזל, עבור ערכים קטנים של $latex {n}$ יש רק מעט צורות שיכולות להיות לעץ, ואפשר לספור כמה עצים יש מכל צורה ללא קושי רב. זה נעשה בציור הבא.
</p>

<p style="direction: rtl;">
  בדרך כלל אפשר לשים את קודקודי צורה על קבוצת $latex {n}$ הקודקודים הנתונים ("לקרוא לקודקודי הצורה בשמות") ב $latex {n!}$ אופנים שונים. אבל, אם לצורה יש סימטריה, אזי אותו עץ יתקבל מ"קריאה כלשהי בשמות" ומתמונתה ע"י פעולת סימטריה. כדי למצוא את מספר העצים השונים מכל צורה יש לחלק את $latex {n!}$ במספר פעולות הסימטריה שיש לצורה (במלים אחרות, בסדר חבורת הסימטריה שלה).
</p>

<p style="direction: rtl;">
  <img class="aligncenter size-full wp-image-2226" src="{{site.baseurl}}/assets/img/2015/02/kl-cy2.jpg" alt="kl-cy2" width="345" height="278" />
</p>

<table style="direction: rtl; margin: 0px auto; border-color: transparent !important;">
  <tr>
    <td style="text-align: center; border: 0px solid white;">
      מס' העצים
    </td>
    
    <td style="text-align: center; border: 0px solid white;">
      $latex {n}$
    </td>
  </tr>
  
  <tr>
    <td style="text-align: center; border: 0px solid white;">
      $latex {1}$
    </td>
    
    <td style="text-align: center; border: 0px solid white;">
      $latex {n=2}$
    </td>
  </tr>
  
  <tr>
    <td style="text-align: center; border: 0px solid white;">
      $latex {3}$
    </td>
    
    <td style="text-align: center; border: 0px solid white;">
      $latex {n=3}$
    </td>
  </tr>
  
  <tr>
    <td style="text-align: center; border: 0px solid white;">
      $latex {16}$
    </td>
    
    <td style="text-align: center; border: 0px solid white;">
      $latex {n=4}$
    </td>
  </tr>
  
  <tr>
    <td style="text-align: center; border: 0px solid white;">
      $latex {125}$
    </td>
    
    <td style="text-align: center; border: 0px solid white;">
      $latex {n=5}$
    </td>
  </tr>
</table>

<p style="direction: rtl;">
  מוצאים, עבור מספר העצים $latex {c(n)}$ על $latex {n}$ קודקודים: $latex {c(3)=3^1}$, $latex {c(4)=4^2}$, $latex {c(5)=5^3}$, וזה מביא להשערה שהתשובה היא $latex {c(n)=n^{n-2}}$. זה פועל אפילו עבור $latex {n=2}$: $latex {c(2)=1=2^0}$.
</p>

<p style="direction: rtl;">
  נבדוק את $latex {n=6}$, בציור מתוארות הצורות האפשריות:
</p>

<p style="direction: rtl; text-align: center;">
  <img class="aligncenter size-full wp-image-2225" src="{{site.baseurl}}/assets/img/2015/02/kl-cy3.jpg" alt="kl-cy3" width="535" height="142" />הצורות עבור $latex {n=6}$
</p>

<p style="direction: rtl; text-align: right;">
  $latex {360\cdot3+90+120+6=1296=6\cdot6\cdot6\cdot6}$
</p>

<p style="direction: rtl;">
  אם אתם כמוני (וכמו קיילי) , אתם בוודאי כבר משוכנעים שהתשובה הכללית היא $latex {n^{n-2}}$.
</p>

<p style="direction: rtl;">
  זה מה שנוכיח. כדי לעשות זאת, נשאל קודם: מה אנו יודעים שהמספר הזה, $latex {n^{n-2}}$ מונה?
</p>

<p style="direction: rtl;">
  אם נבדוק שוב מקרים קטנים, נראה ש $latex {3=(1+1+1)}$, $latex {4^2=(1+1+1+1)\cdot(1+1+1+1)}$, ובאופן כללי $latex {n^{n-2}}$ הוא מכפלה של <i>$latex {n-2}$ גורמים זהים</i> שכל אחד מהם הוא <i>סכום $latex {n}$ $latex {1}$ -ים</i>.
</p>

<p style="direction: rtl;">
  אפשר להשתמש בחוק הדיסטריבוטיבי (חוק הפילוג) לגבי מכפלה זו פעם אחר פעם עד שהופכים אותה לסכום של מכפלות של אברים בודדים מהגורמים המקוריים. כיון שכל איבר כזה הוא $latex {1}$, כל המכפלות האלה יהיו שוות ל $latex {1}$, ו $latex {n^{n-2}}$ שלנו הוא מספר האברים השונים שמתקבלים מהפעלת חוק הפילוג כאן.
</p>

<p style="direction: rtl;">
  <em>לכן $latex {n^{n-2}}$ מונה את מספר הדרכים השונות לבחור אפשרות אחת מבין $latex {n}$ אפשרויות, $latex {n-2}$ פעמים נבדלות.</em>
</p>

<p style="direction: rtl;">
  אנו רוצים להשתמש בכך, ולהוכיח שאותו מספר מונה גם את מספר העצים.
</p>

<p style="direction: rtl;">
  זו תהיה דרך המחשבה של הוכחתנו:
</p>

<ul style="margin-right: 30px;">
  <li style="direction: rtl;">
    $latex {n^{n-2}}$ יכול להיכתב כמכפלה של סכומי $latex {1}$ -ים בסוגריים.
  </li>
  <li style="direction: rtl;">
    כל איבר שמתקבל אחרי פתיחת הסוגריים ניתן לתיאור ע"י "פונקציה".
  </li>
  <li style="direction: rtl;">
    כל פונקציה כזו קובעת גרף מכוון.
  </li>
  <li style="direction: rtl;">
    כל גרף מכוון כזה מתאים לעץ מסוים וכל העצים מתקבלים באופן כזה.
  </li>
  <li style="direction: rtl;">
    לכן $latex {n^{n-2}}$ הוא מספר העצים.
  </li>
</ul>

<p style="direction: rtl;">
  אנו הופכים איבר בפיתוח המכפלה לפי חוק הפילוג לפונקציה באופן הבא: איבר מהווה בחירה של מקום אחד בכל אחד מהסוגריים. אם ניתן למקומות השונים שמות $latex {1,2,\ldots,n}$, אזי כל איבר מתאים להתאמת אחד ממספרים טבעיים אלה לכל אחד מהסוגריים. זוהי הפונקציה שמתאימה לאיבר.
</p>

<p style="direction: rtl;">
  הנה דוגמה עם $latex {n=5}$.
</p>

<p style="direction: rtl;" align="center">
  $latex \displaystyle 5^3=(1+1+1+\underline{ 1}+1) (1+1+\underline{ 1}+1+1) (1+\underline{ 1}+1+1+1)$
</p>

<p style="direction: rtl;">
  את האיברים המודגשים בקו מתחת אפשר לתאר ע"י ה"פונקציה" או ההתאמה $latex {f(3)=2}$ ,$latex {f(2)=3}$ ,$latex {f(1)=4}$. וכל איבר בפיתוח המכפלה מתואר ע"י פונקציה אחרת.
</p>

<p style="direction: rtl;">
  אפשר לבנות גרף מכוון שמתאים לפונקציה כזו ע"י כך שמפרשים את העובדה $latex {f(1)=4}$, למשל, בתור קיום צלע מכוונת מ $latex {1}$ ל $latex {4}$.
</p>

<p style="direction: rtl;">
  זהו, איפוא, הגרף המכוון שמתאים לפונקציה שבאה מהאיבר לעיל: <img class="aligncenter size-full wp-image-2224" src="{{site.baseurl}}/assets/img/2015/02/kl-cy4.jpg" alt="kl-cy4" width="249" height="121" />
</p>

<p style="direction: rtl; text-align: center;">
  $latex {f(1)=4, f(2)=3, f(3)=2}$
</p>

<p style="direction: rtl;">
  הגרפים שאנו מקבלים בצורה כזאת אינם עצים. למשל, אלה גרפים מכוונים בעוד שעצים אינם מכוונים. את זה קל לתקן: אפשר לכוון את הצלעות בכל עץ כך שיתכוונו אל הקודקוד $latex {n}$. אז כל עץ נהפך לגרף מכוון; אבל זה עדיין לא נראה כמו הגרפים שלנו.
</p>

<p style="direction: rtl;">
  <img class="aligncenter size-full wp-image-2223" src="{{site.baseurl}}/assets/img/2015/02/kl-cy5_1.jpg" alt="kl-cy5_1" width="278" height="130" />
</p>

<p style="direction: rtl; text-align: center;">
  עץ
</p>

<p style="direction: rtl;">
  <img class="aligncenter size-full wp-image-2222" src="{{site.baseurl}}/assets/img/2015/02/kl-cy5_2.jpg" alt="kl-cy5_2" width="278" height="130" />
</p>

<p style="direction: rtl; text-align: center;">
  עץ עם צלעות מכוונות לכיוון $latex {n}$, $latex {n=7}$
</p>

<p style="direction: rtl;">
  כאשר מתייחסים לעצים באופן כזה, הם נבדלים מהגרפים שלנו בשלושה אופנים: <i>בכל אחד מהם יש צלע שיוצאת מ $latex {n-1}$, בעוד שבגרפים שלנו אין</i><i>אין בהם מעגלים, בעוד שבגרפים שלנו יכולים להיות</i>;. בנוסף לכך, בכל עץ, המכוון באופן זה, יש <i>צלע מכוונת ל $latex {n}$</i>בגרפים שלנו לא חייבת להיות צלע כזו.
</p>

<p style="direction: rtl;">
  כך נהפוך כל אחד מהגרפים שלנו לעץ: נתון גרף כזה $latex {G}$, <em>ניצור מסלול מ $latex {n-1}$ ל $latex {n}$, שעובר דרך כל מעגל ב $latex {G}$ והורס אותו</em>. אם אנו יכולים גם להפוך (לבטל) את התהליך באופן חד-ערכי, אז גמרנו.
</p>

<p style="direction: rtl;">
  איך? נסדר את המעגלים לפי הקודקוד הגדול ביותר בהם (כלומר הקודקוד שהאינדקס המספרי שלו: $latex {1,2,\ldots,n}$ הוא הגדול ביותר) , הגדול ביותר תחילה; ניתן למסלול שלנו להתחיל ב $latex {n-1}$ ולהיכנס לכל מעגל מייד אחרי הקודקוד הגדול ביותר במעגל, ולצאת אל המעגל הבא (או, אם אין יותר, אל $latex {n}$) בקודקוד הגדול ביותר (ובכך תישמט הצלע מהקודקוד הגדול ביותר אל העוקב לו במעגל) . כעת אנו עוברים למעגל בעל הקודקוד השני בגודלו וחוזרים על הבניה, עד שאין יותר מעגלים.
</p>

<p style="direction: rtl;">
  <i><i>הנה דוגמה כיצד זה נעשה: </i></i>
</p>

<p style="direction: rtl;">
  $latex {f(1)=4,\,f(2)=3,\,f(3)=2}$
</p>

<p style="direction: rtl;">
  $latex {n-1=4}$
</p>

<p style="direction: rtl;">
  <img class="aligncenter size-full wp-image-2221" src="{{site.baseurl}}/assets/img/2015/02/kl-cy6.jpg" alt="kl-cy6" width="249" height="124" />
</p>

<p style="direction: rtl; text-align: center;">
  כדי להפוך לעץ:<br /> הוסף צלע מ $latex {n-1}$ לקודקוד שאחרי הגדול ביותר במעגל: $latex {\{4,2\}}$<br /> הוסף צלע מהגדול ביותר במעגל אל המעגל הבא או אל $latex {n}$: $latex {\{3,5\}}$<br /> השמט את הצלע במעגל היוצאת מהקודקוד הגדול ביותר: $latex {\{3,2\}}$
</p>

<p style="direction: rtl;">
  כדי להפוך (לבטל) את הבניה - כדי לקבל את $latex {G}$ מהעץ המתאים $latex {T}$, מצא את המסלול מ $latex {n-1}$ ל $latex {n}$ ב $latex {T}$; הקודקוד הגדול ביותר במסלול זה מסמן את קצה המעגל הראשון ב $latex {G}$. בנה מחדש מעגל זה, השמט את הצלע שיוצאת מ $latex {n-1}$, ועבור למעגל הבא; בנה אותו מחדש באופן דומה, והמשך עד שיצרת את $latex {G}$.
</p>

<p style="direction: rtl;">
  <img class="aligncenter size-full wp-image-2220" src="{{site.baseurl}}/assets/img/2015/02/kl-cy7.jpg" alt="kl-cy7" width="254" height="138" />
</p>

<p style="direction: rtl;">
  $latex {G\setminus T}$ מורכב מצלע מכל מעגל - זו שיוצאת מהקודקוד הגדול ביותר במעגל.<br /> $latex {T\setminus G}$ מורכב מצלע מ $latex {n-1}$ למעגל הראשון, צלעות מהקודקוד הגדול ביותר בכל מעגל אל העוקב לגדול ביותר במעגל הבא, ולבסוף צלע אל $latex {n}$. הוכחנו את נוסחת קיילי. אם אתם רוצים לשכנע את עצמכם ששיקולים אלה פועלים, נסו לצייר כמה עצים ולהפוך אותם לגרפים, לפונקציות ולאיברים בפיתוח של $latex {n^{n-2}}$ וללכת גם בדרך ההפוכה. התהליך של המרת מעגלים במסלול כמו שאנו עושים זאת כאן מזכיר לי עשיית מחרוזת עם חרוזים מסודרים לפי הגודל.
</p>

<p style="direction: rtl;">
  <b>הערה <b>נוספת:</b> </b>הפונקציה $latex {(x_1+x_2+\cdots+x_n)^{n-2}}$, כאשר מפתחים אותה לפי חוק הפילוג (החוק הדיסטריבוטיבי) , מורכבת מ $latex {n^{n-2}}$ איברים, אחד עבור כל גרף $latex {G}$, ולכן אחד עבור כל עץ, בדיוק כמו לעיל, פרט לכך שהאיברים אינם כולם $latex {1}$. באיבר שנתרם ע"י עץ מסויים יש חזקה $latex {x_j}^k $ אם $latex {j}$ נלקח $latex {k}$ פעמים בבניית האיבר המתאים מחוק הפילוג; זה אומר ש<i>הערכיות הנכנסת</i> של הקודקוד $latex {j}$ ב $latex {G}$ היא $latex {k}$.
</p>

<p style="direction: rtl;">
  כל <i>ערכיות ב $latex {T}$</i> היא בדיוק ב $latex {1}$ יותר מ<i>הערכיות הנכנסת של אותו קודקוד ב $latex {G}$</i>לכן הפונקציה לעיל היא הסכום על העצים של המכפלה עבור אינדקסים $latex {j}$ בין $latex {1}$ ו $latex {n}$ של $latex {x_j}$ מועלה לחזקה שהיא ערכיות הקודקוד $latex {j}$ ב $latex {T}$ פחות $latex {1}$. בסימון מתמטי זה נכתב כך: <b><br /> </b>
</p>

<p style="direction: rtl;" align="center">
  $latex \displaystyle \prod_{j=1}^n \left((x_j)^{d_j(T)-1}\right)$
</p>

<p style="direction: rtl;">
  הטענה האומרת ששתי ישויות אלה הן שוות היא הצורה החזקה המקובלת של נוסחת קיילי.
</p>

<p style="direction: rtl;">
  יש תריסרי הוכחות שונות לנוסחת קיילי, אבל כולן נראות קצת קשות יותר מזו שהבאנו. ההוכחה הקרובה לה ביותר ברוחה היא של $latex Chen$.
</p>